# DANGA 진행사항 (MVP 최종)

기준일: 2026-02-15  
스택: Next.js(App Router) + TypeScript + Tailwind + Supabase + Cloudflare R2

## 1. 현재 결론
- MVP 범위 구현 완료
- 핵심 사용자 플로우 동작 확인
  - 로그인 -> 이미지 업로드 -> 게시글 작성 -> 피드/상세 -> 좋아요/댓글 -> 랭킹/알림
- 코드 품질 기준 충족
  - `npm run lint` 통과
  - `npm run build` 통과

## 2. 구현 완료 범위
### 2-1. 사용자 기능
- 랜딩(`/`) 섹션형 구성 + CTA
- 피드(`/feed`)
  - 최신순 목록, 좋아요 토글, 태그 chip, 검색 진입
- 상세(`/p/[id]`)
  - 이미지/캡션/태그, 좋아요, 댓글, 신고
- 글쓰기(`/post/new`)
  - R2 업로드 + 캡션/태그 입력 + 게시글 저장
- 검색(`/search`)
  - 키워드 + 태그 필터, 20개 단위 더보기
- 랭킹(`/rank`)
  - 주간/월간 탭, Top 50, 배지/점수 표시
- 마이(`/me`)
  - 내 글/내 좋아요/내 댓글 탭
  - 프로필 수정, 계정 탈퇴(soft delete)
- 알림(`/notifications`)
  - 좋아요/댓글 기반 알림, 읽음/모두 읽음

### 2-2. 관리자/운영 기능
- 신고 등록(게시글/댓글)
- 관리자(`/admin`)
  - 권한 체크(`profiles.role='admin'`)
  - 신고 상태 변경
  - 대상 soft delete RPC 실행

### 2-3. 품질/운영 보강
- SEO metadata, OG/Twitter
- `robots.txt`, `sitemap.xml`
- 정책 페이지(`/privacy`, `/terms`, `/contact`)
- `next/image` 최적화 + remotePatterns
- 서버 전용 AES-256-GCM 암호화 유틸

### 2-4. UI 통일 스프린트
- 디자인 토큰/공통 UI 컴포넌트 정리(`components/ui/*`)
- 공통 레이아웃 정리(`components/layout/Header.tsx`, `components/layout/Footer.tsx`)
- 피드/상세/글쓰기/검색/알림 UI 톤 통일
- 카피 톤 통일
  - `시작하기` -> `로그인하고 시작`
  - `구경하기` -> `피드 보기`
  - `업로드` -> `코디 올리기`
  - 댓글 placeholder -> `한 줄 피드백 남겨줘`

## 3. Supabase 반영 상태
### 3-1. 주요 리소스
- 테이블: `profiles`, `posts`, `votes`, `comments`, `reports`, `notifications`
- 뷰: `weekly_post_rankings`, `monthly_post_rankings`
- RPC: `admin_soft_delete_post`, `admin_soft_delete_comment`, `is_admin`, `notify_vote`, `notify_comment`, `admin_list_profile_identities`

### 3-2. 마이그레이션
- `supabase/migrations/20260216_create_posts.sql`
- `supabase/migrations/20260216_create_votes.sql`
- `supabase/migrations/20260216_create_reports_admin.sql`
- `supabase/migrations/20260216_create_notifications.sql`
- `supabase/migrations/20260216_profiles_soft_delete.sql`
- `supabase/migrations/20260216_profiles_encryption.sql`
- `supabase/migrations/20260216_add_posts_tags.sql`

### 3-3. SQL 문서
- `docs/sql/profiles.sql`
- `docs/sql/posts.sql`
- `docs/sql/posts_tags.sql`
- `docs/sql/votes.sql`
- `docs/sql/reports.sql`
- `docs/sql/notifications.sql`
- `docs/sql/profiles_encryption.sql`

## 4. 라우트 현황
- 공개: `/`, `/feed`, `/rank`, `/search`, `/p/[id]`, `/privacy`, `/terms`, `/contact`
- 로그인 기반: `/post/new`, `/me`, `/notifications`
- 관리자: `/admin`
- API: `/api/upload`, `/api/posts`, `/api/votes`, `/api/comments`, `/api/reports`, `/api/profiles/encrypted`, `/auth/callback`

## 5. 표기 정책(최신)
- 작성자 표기는 `profiles.nickname` 우선
- 닉네임 미설정 시 `익명`
- 기존 `@user_xxx` 표기 제거

## 6. 운영 체크리스트
### 6-1. 필수 환경 변수
- Supabase: `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- R2: `R2_ACCOUNT_ID`, `R2_ACCESS_KEY_ID`, `R2_SECRET_ACCESS_KEY`, `R2_BUCKET_NAME`, `R2_PUBLIC_BASE_URL`
- 암호화: `APP_ENCRYPTION_KEY` (base64 32bytes)

### 6-2. 최종 QA 항목
- 로그인/로그아웃/세션 유지
- 이미지 업로드 -> 게시글 저장 -> 피드 반영
- 좋아요/댓글/신고 동작
- 키워드/태그 검색 및 태그 이동
- 알림 생성/읽음 처리
- 관리자 상태 변경/숨김 처리 반영

## 7. MVP 제외(후속)
- 댓글 좋아요/대댓글/멘션
- 고급 검색(정렬·추천)
- 푸시/이메일 알림
- Realtime 고도화
- 운영 대시보드/실험 도구

---

이 문서는 MVP 최종 스냅샷 문서다.  
다음 작업 계획과 실험성 아이디어는 `docs/1.md`에서 계속 관리한다.
